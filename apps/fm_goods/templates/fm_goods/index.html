{% extends 'base.html' %}

{% block title %}Flea Market - Home{% endblock %}

{% block content %}
  <div class="row">
    <div class="twelve columns">
      <section class="search-section">
        <form action="{% url 'fm_goods:search' %}" method="get">
          <div class="search-bar">
            <input type="text" name="q" placeholder="Search for products..." required>
            <button type="submit" class="button button-primary">Search</button>
          </div>
        </form>
      </section>
    </div>
  </div>

  <div class="row">
    <div class="twelve columns">
      <h3>New Items</h3>
      <ul class="product-grid">
        {% for product in newest_products %}
        <li class="product-item">
          <a href="{% url 'fm_goods:detail' product.id %}">
            <img src="{{ MEDIA_URL }}{{ product.gpic }}" alt="{{ product.gtitle }}">
            <div class="product-title">{{ product.gtitle }}</div>
            <div class="product-price">${{ product.gprice }}</div>
          </a>
        </li>
        {% empty %}
        <li><em>No new products available.</em></li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="twelve columns">
      <h3>Popular Items</h3>
      <ul class="product-grid">
        {% for product in popular_products %}
        <li class="product-item">
          <a href="{% url 'fm_goods:detail' product.id %}">
            <img src="{{ MEDIA_URL }}{{ product.gpic }}" alt="{{ product.gtitle }}">
            <div class="product-title">{{ product.gtitle }}</div>
            <div class="product-price">${{ product.gprice }}</div>
          </a>
        </li>
        {% empty %}
        <li><em>No popular products available.</em></li>
        {% endfor %}
      </ul>
    </div>
  </div>

  {% if request.session.user_name %}
  <div class="row">
    <div class="twelve columns text-center">
      <a href="{% url 'fm_goods:add_product' %}" class="button button-primary">Add New Product</a>
    </div>
  </div>
  {% endif %}
{% endblock %}